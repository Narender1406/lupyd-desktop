import{r as i,u as v,a1 as N,a0 as a,j as e,D as y,w as P,I as T,B as j,F,T as S,a as U,b,p as k,c as w,J as C,a2 as D,L as E,a3 as $}from"./index-BQMOqxJW.js";import{P as B,a as I}from"./post-card-DDcFqNjL.js";import{T as L}from"./trending-up-x-x0A1mN.js";import"./dropdown-menu-BRjx-zb6.js";import"./chevron-right-DOyZUz7b.js";import"./circle-yRhyIrH_.js";import"./dialog-p-OgizUJ.js";import"./use-toast-CCyZQtCu.js";import"./share-2-GZbPQSse.js";import"./mail-9pMy_HaE.js";import"./van-D2Gtfm5B.js";import"./thumbs-up-BrVNxF5m.js";import"./send-DHNXlGmv.js";function Z(){const[t,u]=i.useState(""),[o,d]=i.useState([]),[h,p]=i.useState([]),m=async s=>{if(console.log(`Searching for '${s}'`),s.length<2){console.log("Not enough info to search for");return}const r=[];if(s.length>3){const l=a.getPosts({fetchType:a.FetchType.Search,fetchTypeFields:s}).then(c=>{d(c);for(const g of c)console.log(g)});r.push(l)}{const l=a.getUsers(s).then(c=>{p(c);for(const g of c)console.log(g)});r.push(l)}await Promise.all(r)},x=v(),f=s=>{if((s.code||s.key)!="Enter"||!t.trim())return;const l=`/discover?q=${encodeURIComponent(t)}`;x(l)},[n,A]=N();return i.useEffect(()=>{const s=n.get("q");if(s){u(s),m(s);return}const r=n.get("hashtag");if(r){const l=Number(n.get("offset"))||0;a.getPosts({fetchType:a.FetchType.Hashtag,fetchTypeFields:r,offset:l}).then(c=>{d(c)});return}},[n]),e.jsx(y,{children:e.jsxs("div",{className:"container mx-auto px-4 max-w-full overflow-hidden",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Discover"}),e.jsx("p",{className:"text-muted-foreground",children:"Explore new content, people, and communities"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(T,{placeholder:"Search for people, topics, or content...",className:"pl-10 bg-white border-none shadow-sm w-full",onKeyDown:f,value:t,onChange:s=>{u(s.target.value)}})]}),e.jsxs(j,{variant:"outline",className:"flex items-center w-full sm:w-auto",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Filters"]})]}),e.jsx("div",{className:"overflow-hidden",children:e.jsxs(S,{defaultValue:"posts",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto pb-2",children:e.jsxs(U,{className:"mb-6 bg-transparent border-b w-full justify-start rounded-none p-0 h-auto flex-nowrap",children:[e.jsxs(b,{value:"posts",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-black data-[state=active]:bg-transparent py-2 px-4 whitespace-nowrap",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Posts",o.length!=0&&e.jsx("span",{className:"rounded-full bg-gray-200 px-2 py-0.5 text-sm font-semibold text-gray-700",children:o.length.toString()})]}),e.jsxs(b,{value:"people",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-black data-[state=active]:bg-transparent py-2 px-4 whitespace-nowrap",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"People",h.length!=0&&e.jsx("span",{className:"rounded-full bg-gray-200 px-2 py-0.5 text-sm font-semibold text-gray-700",children:h.length.toString()})]})]})}),e.jsx(w,{value:"posts",className:"mt-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Posts"}),o.map(s=>e.jsx(B,{post:s},a.ulidStringify(s.id)))]}),e.jsx("div",{className:"space-y-6"})]})}),e.jsx(w,{value:"people",className:"mt-0",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(s=>e.jsx(z,{...s},s.uname))})})]})})]})})}function z(t){const u=v(),[o,d]=i.useState(!1),h=t.bio.length>0?a.PostProtos.PostBody.decode(t.bio):a.PostProtos.PostBody.create({plainText:""}),p=C(),m=D(),x=()=>{u(`/messages/${t.uname}`)};i.useEffect(()=>{d(m.follows.includes(t.uname)),console.log(`isFollowing '${t.uname}'? : ${o}`)},[m]);const f=()=>{o?(m.relationState.unfollowUser(t.uname),d(!1)):(m.relationState.followUser(t.uname),d(!0))},n=i.useMemo(()=>p.username==t.uname,[p]);return e.jsx(e.Fragment,{children:e.jsx(E,{to:`/user/${t.uname}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center min-w-0",children:[e.jsx($,{username:t.uname}),e.jsxs("div",{className:"ml-3 overflow-hidden",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.uname}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:e.jsx(I,{...h})})]})]}),!n&&(t.settings&1)==1&&e.jsx(j,{variant:"outline",size:"sm",className:"flex-shrink-0 ml-2",onClick:x,children:"Connect"}),!n&&e.jsx(j,{variant:"outline",size:"sm",className:"flex-shrink-0 ml-2",onClick:f,children:o?"Unfollow":"Follow"})]},t.uname)})})}export{Z as default};
