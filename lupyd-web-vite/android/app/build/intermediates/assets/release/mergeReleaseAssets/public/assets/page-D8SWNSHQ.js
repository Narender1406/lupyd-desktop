import{n as V,j as s,a3 as P,a0 as l,B as v,L as B,J as U,u as J,C as N,g as _,I as q,al as R,am as Y,r as x,a2 as M,D as $,T as W,a as k,b as T,c as F,d as b,e as S,f as G}from"./index-BQMOqxJW.js";import{A as C}from"./animated-card-DfqHQIti.js";import{I as D}from"./image-CM1tGAhc.js";import{V as L}from"./video-E8zllIXl.js";import{F as Q}from"./file-text-C5butGvf.js";import{S as X,I as O}from"./index.es-DLlNA55s.js";import{P as E}from"./post-card-DDcFqNjL.js";import{T as Z}from"./trending-up-x-x0A1mN.js";import"./dropdown-menu-BRjx-zb6.js";import"./chevron-right-DOyZUz7b.js";import"./circle-yRhyIrH_.js";import"./dialog-p-OgizUJ.js";import"./use-toast-CCyZQtCu.js";import"./share-2-GZbPQSse.js";import"./mail-9pMy_HaE.js";import"./van-D2Gtfm5B.js";import"./thumbs-up-BrVNxF5m.js";import"./send-DHNXlGmv.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],H=V("loader-circle",K);function ee({user:d=l.UserProtos.User.create(),actionLabel:u="Connect",onAction:f,secondaryActionLabel:i,onSecondaryAction:c,delay:e=0,size:t="md",orientation:r="horizontal"}){return r==="vertical"?s.jsx(C,{delay:e,children:s.jsxs("div",{className:"flex flex-col items-center text-center p-4",children:[s.jsx(P,{username:d.uname}),s.jsx("div",{className:"mt-3",children:s.jsx("p",{className:"font-medium",children:d.uname})}),s.jsxs("div",{className:"mt-3 flex space-x-2",children:[u&&s.jsx(v,{size:"sm",variant:i?"outline":"default",className:i?"":"bg-black text-white hover:bg-gray-800",onClick:f,children:u}),i&&s.jsx(v,{size:"sm",variant:"outline",onClick:c,children:i})]})]})}):s.jsx(C,{delay:e,children:s.jsxs("div",{className:"flex items-center justify-between p-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(P,{username:d.uname}),s.jsx("div",{})]}),s.jsxs("div",{className:"flex space-x-2",children:[u&&s.jsx(v,{size:"sm",variant:i?"outline":"default",className:i?"":"bg-black text-white hover:bg-gray-800",onClick:f,children:u}),i&&s.jsx(v,{size:"sm",variant:"outline",onClick:c,children:i})]})]})})}function se({name:d,total:u,delay:f=0}){return s.jsx(C,{delay:f,children:s.jsx(B,{to:`/discover?hashtag=${d}`,children:s.jsxs("div",{className:"mb-3",children:[s.jsxs("p",{className:"text-sm font-medium",children:["#",d]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[l.Utils.formatNumber(u)," posts"]})]})})})}function te(){const{username:d}=U(),u=J(),f=()=>{u("/create-post")};async function i(){await R.get({url:"http://192.168.1.4:8080"}),console.log("doing-------smthng")}return s.jsx(N,{className:"border-none shadow-sm",children:s.jsx(_,{className:"p-4",children:s.jsxs("div",{className:"flex space-x-4",children:[s.jsx(P,{username:d??""}),s.jsxs("div",{className:"flex-1",children:[s.jsx(q,{placeholder:"What's on your mind?",className:"bg-gray-100 border-none",onMouseDown:f}),s.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 overflow-x-auto md:overflow-visible",children:[s.jsxs(v,{variant:"ghost",size:"sm",className:"text-gray-500 whitespace-nowrap",onClick:f,children:[s.jsx(D,{className:"h-4 w-4 mr-2"}),"Photo"]}),s.jsxs(v,{variant:"ghost",size:"sm",className:"text-gray-500 whitespace-nowrap",onClick:i,children:[s.jsx(D,{className:"h-4 w-4 mr-2"}),"developer"]}),s.jsxs(v,{variant:"ghost",size:"sm",className:"text-gray-500 whitespace-nowrap",onClick:f,children:[s.jsx(L,{className:"h-4 w-4 mr-2"}),"Video"]}),s.jsxs(v,{variant:"ghost",size:"sm",className:"text-gray-500 whitespace-nowrap",onClick:f,children:[s.jsx(Q,{className:"h-4 w-4 mr-2"}),"Document"]}),s.jsxs(v,{variant:"ghost",size:"sm",className:"text-gray-500 whitespace-nowrap",onClick:f,children:[s.jsx(X,{className:"h-4 w-4 mr-2"}),"Feeling"]})]})]})]})})})}var w={exports:{}};/*! store2 - v2.14.4 - 2024-12-26
* Copyright (c) 2024 Nathan Bubna; Licensed MIT */var I=w.exports,z;function re(){return z||(z=1,function(d){(function(u,f){var i={version:"2.14.4",areas:{},apis:{},nsdelim:".",inherit:function(e,t){for(var r in e)t.hasOwnProperty(r)||Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r));return t},stringify:function(e,t){return e===void 0||typeof e=="function"?e+"":JSON.stringify(e,t||i.replace)},parse:function(e,t){try{return JSON.parse(e,t||i.revive)}catch{return e}},fn:function(e,t){i.storeAPI[e]=t;for(var r in i.apis)i.apis[r][e]=t},get:function(e,t){return e.getItem(t)},set:function(e,t,r){e.setItem(t,r)},remove:function(e,t){e.removeItem(t)},key:function(e,t){return e.key(t)},length:function(e){return e.length},clear:function(e){e.clear()},Store:function(e,t,r){var n=i.inherit(i.storeAPI,function(o,h,m){return arguments.length===0?n.getAll():typeof h=="function"?n.transact(o,h,m):h!==void 0?n.set(o,h,m):typeof o=="string"||typeof o=="number"?n.get(o):typeof o=="function"?n.each(o):o?n.setAll(o,h):n.clear()});n._id=e;try{var a="__store2_test";t.setItem(a,"ok"),n._area=t,t.removeItem(a)}catch{n._area=i.storage("fake")}return n._ns=r||"",i.areas[e]||(i.areas[e]=n._area),i.apis[n._ns+n._id]||(i.apis[n._ns+n._id]=n),n},storeAPI:{area:function(e,t){var r=this[e];return(!r||!r.area)&&(r=i.Store(e,t,this._ns),this[e]||(this[e]=r)),r},namespace:function(e,t,r){if(r=r||this._delim||i.nsdelim,!e)return this._ns?this._ns.substring(0,this._ns.length-r.length):"";var n=e,a=this[n];if((!a||!a.namespace)&&(a=i.Store(this._id,this._area,this._ns+n+r),a._delim=r,this[n]||(this[n]=a),!t))for(var o in i.areas)a.area(o,i.areas[o]);return a},isFake:function(e){return e?(this._real=this._area,this._area=i.storage("fake")):e===!1&&(this._area=this._real||this._area),this._area.name==="fake"},toString:function(){return"store"+(this._ns?"."+this.namespace():"")+"["+this._id+"]"},has:function(e){return this._area.has?this._area.has(this._in(e)):this._in(e)in this._area},size:function(){return this.keys().length},each:function(e,t){for(var r=0,n=i.length(this._area);r<n;r++){var a=this._out(i.key(this._area,r));if(a!==void 0&&e.call(this,a,this.get(a),t)===!1)break;n>i.length(this._area)&&(n--,r--)}return t||this},keys:function(e){return this.each(function(t,r,n){n.push(t)},e||[])},get:function(e,t){var r=i.get(this._area,this._in(e)),n;return typeof t=="function"&&(n=t,t=null),r!==null?i.parse(r,n):t??r},getAll:function(e){return this.each(function(t,r,n){n[t]=r},e||{})},transact:function(e,t,r){var n=this.get(e,r),a=t(n);return this.set(e,a===void 0?n:a),this},set:function(e,t,r){var n=this.get(e),a;return n!=null&&r===!1?t:(typeof r=="function"&&(a=r,r=void 0),i.set(this._area,this._in(e),i.stringify(t,a),r)||n)},setAll:function(e,t){var r,n;for(var a in e)n=e[a],this.set(a,n,t)!==n&&(r=!0);return r},add:function(e,t,r){var n=this.get(e);if(n instanceof Array)t=n.concat(t);else if(n!==null){var a=typeof n;if(a===typeof t&&a==="object"){for(var o in t)n[o]=t[o];t=n}else t=n+t}return i.set(this._area,this._in(e),i.stringify(t,r)),t},remove:function(e,t){var r=this.get(e,t);return i.remove(this._area,this._in(e)),r},clear:function(){return this._ns?this.each(function(e){i.remove(this._area,this._in(e))},1):i.clear(this._area),this},clearAll:function(){var e=this._area;for(var t in i.areas)i.areas.hasOwnProperty(t)&&(this._area=i.areas[t],this.clear());return this._area=e,this},_in:function(e){return typeof e!="string"&&(e=i.stringify(e)),this._ns?this._ns+e:e},_out:function(e){return this._ns?e&&e.indexOf(this._ns)===0?e.substring(this._ns.length):void 0:e}},storage:function(e){return i.inherit(i.storageAPI,{items:{},name:e})},storageAPI:{length:0,has:function(e){return this.items.hasOwnProperty(e)},key:function(e){var t=0;for(var r in this.items)if(this.has(r)&&e===t++)return r},setItem:function(e,t){this.has(e)||this.length++,this.items[e]=t},removeItem:function(e){this.has(e)&&(delete this.items[e],this.length--)},getItem:function(e){return this.has(e)?this.items[e]:null},clear:function(){for(var e in this.items)this.removeItem(e)}}},c=i.Store("local",function(){try{return localStorage}catch{}}());c.local=c,c._=i,c.area("session",function(){try{return sessionStorage}catch{}}()),c.area("page",i.storage("page")),typeof f=="function"&&f.amd!==void 0?f("store2",[],function(){return c}):d.exports?d.exports=c:(u.store&&(i.conflict=u.store),u.store=c)})(I,I&&I.define)}(w)),w.exports}var ne=re();const A=Y(ne);function ie(){const[d,u]=x.useState([]),[f,i]=x.useState(!0);let[c,e]=x.useState(void 0);const t=M(),r=async()=>{const o={fetchType:l.FetchType.Latest,start:c?l.ulidStringify(c):void 0,allowedPostTypes:Number(A.get("allowedPostsTypes")??"1")};console.log({details:o});const h=await l.getPosts(o);if(h.length===0){i(!1);return}let m=h.map(p=>l.ulidStringify(p.id)).reduce((p,g)=>p>g?g:p);(!c||l.ulidStringify(c)>m)&&e(l.ulidFromString(m)),u(p=>{const g=new Set(p.map(y=>l.ulidStringify(y.id))),j=[...p];for(const y of h)g.has(l.ulidStringify(y.id))||j.push(y);return j})},n=async()=>{const o=t.follows;if(o.length==0)return;const h=await l.getPosts({fetchType:l.FetchType.Users,fetchTypeFields:o});u(m=>{const p=new Set(m.map(j=>l.ulidStringify(j.id))),g=[...m];for(const j of h)p.has(l.ulidStringify(j.id))||g.push(j);return g})},a=U();return x.useEffect(()=>{a.username&&n()},[a]),x.useEffect(()=>{r()},[]),s.jsx(O,{dataLength:d.length,next:r,hasMore:f,loader:s.jsx("div",{className:"flex justify-center py-4",children:s.jsx(H,{className:"h-6 w-6 animate-spin text-gray-500"})}),endMessage:s.jsx("p",{className:"text-center py-4 text-sm text-muted-foreground",children:"You've seen all posts for now!"}),children:d.map(o=>{const h=l.ulidStringify(o.id);return s.jsx("div",{className:"mb-6",children:s.jsx(E,{post:o,onDelete:m=>u(p=>p.filter(g=>!indexedDB.cmp(g.id,m)))})},h)})})}function Se(){const[d,u]=x.useState([]),[f,i]=x.useState([]);return x.useEffect(()=>{l.getTrendingHashtags().then(c=>{i(c.hashtags)}).catch(console.error)},[]),s.jsx($,{children:s.jsxs(W,{defaultValue:"feed",className:"w-full",children:[s.jsxs(k,{className:"mb-6 bg-transparent border-b w-full justify-start rounded-none p-0 h-auto overflow-x-auto",children:[s.jsx(T,{value:"feed",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-black data-[state=active]:bg-transparent py-2 px-4",children:"Feed"}),s.jsx(T,{value:"following",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-black data-[state=active]:bg-transparent py-2 px-4",children:"Following"})]}),s.jsx(F,{value:"feed",className:"mt-0",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.jsx(te,{}),s.jsx(ie,{})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs(N,{className:"border-none shadow-sm",children:[s.jsx(b,{className:"p-4 pb-2",children:s.jsx(S,{className:"text-base",children:"People you may know"})}),s.jsxs(_,{className:"p-4 pt-0",children:[s.jsx("div",{className:"space-y-2",children:d.map((c,e)=>s.jsx(ee,{user:c,delay:.1*(e+1),actionLabel:"Connect"},c.uname))}),s.jsx(v,{variant:"ghost",size:"sm",className:"w-full mt-2",children:"View all"})]})]}),s.jsxs(N,{className:"border-none shadow-sm",children:[s.jsx(b,{className:"p-4 pb-2",children:s.jsxs(S,{className:"text-base",children:[s.jsx(Z,{className:"h-3 w-3 mr-1"}),"Trending"]})}),s.jsx(_,{className:"p-4 pt-0",children:s.jsx("div",{className:"space-y-3",children:f.map((c,e)=>s.jsx(se,{...c,delay:.1*(e+1)},c.name))})})]})]})]})}),s.jsx(F,{value:"following",className:"mt-0",children:s.jsx("div",{className:"grid grid-cols-1 gap-6",children:s.jsxs(N,{className:"border-none shadow-sm",children:[s.jsxs(b,{children:[s.jsx(S,{children:"Following Feed"}),s.jsx(G,{children:"Content from people and topics you follow"})]}),s.jsx(_,{children:s.jsx(ae,{})})]})})})]})})}function ae(){const[d,u]=x.useState([]),[f,i]=x.useState(!0),c=M();let[e,t]=x.useState(void 0);const r=async()=>{if(c.follows.length==0)return;const n={fetchType:l.FetchType.Users,fetchTypeFields:[...c.follows],allowedPostTypes:Number(A.get("allowedPostTypes")??"1"),start:e?l.ulidStringify(e):void 0},a=await l.getPosts(n);if(a.length===0){i(!1);return}let o=a.map(h=>l.ulidStringify(h.id)).reduce((h,m)=>h>m?m:h);(!e||l.ulidStringify(e)>o)&&t(l.ulidFromString(o)),u(h=>{const m=new Set(h.map(g=>l.ulidStringify(g.id))),p=[...h];for(const g of a)m.has(l.ulidStringify(g.id))||p.push(g);return p})};return s.jsx(O,{dataLength:d.length,next:r,hasMore:f,loader:s.jsx("div",{className:"flex justify-center py-4",children:s.jsx(H,{className:"h-6 w-6 animate-spin text-gray-500"})}),endMessage:s.jsx("p",{className:"text-center py-4 text-sm text-muted-foreground",children:"You've seen all posts for now!"}),children:d.map(n=>{const a=l.ulidStringify(n.id);return s.jsx("div",{className:"mb-6",children:s.jsx(E,{post:n,onDelete:o=>u(h=>h.filter(m=>!indexedDB.cmp(m.id,o)))})},a)})})}export{ae as FollowingFeed,Se as default};
